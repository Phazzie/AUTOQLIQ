# AutoQliq Application Diagram

## Layered Architecture

```
┌───────────────────────────────────────────────────────────────────────────┐
│                                  UI LAYER                                  │
│                                                                           │
│  ┌─────────────┐   ┌─────────────┐   ┌─────────────┐   ┌─────────────┐    │
│  │WorkflowEditor│   │ActionEditor │   │SettingsView │   │ResultsViewer│    │
│  └──────┬──────┘   └──────┬──────┘   └──────┬──────┘   └──────┬──────┘    │
│         │                 │                 │                 │           │
│  ┌──────┴──────┐   ┌──────┴──────┐   ┌──────┴──────┐   ┌──────┴──────┐    │
│  │WorkflowEditor│   │ActionEditor │   │SettingsPres.│   │ResultsViewer│    │
│  │  Presenter  │   │  Presenter  │   │  Presenter  │   │  Presenter  │    │
│  └──────┬──────┘   └──────┬──────┘   └──────┬──────┘   └──────┬──────┘    │
└─────────┼────────────────┼────────────────┼────────────────┼──────────────┘
          │                │                │                │
┌─────────┼────────────────┼────────────────┼────────────────┼──────────────┐
│         │    APPLICATION LAYER            │                │              │
│         │                │                │                │              │
│  ┌──────┴──────┐   ┌─────┴──────┐   ┌─────┴──────┐   ┌─────┴──────┐       │
│  │WorkflowService│  │ActionService│  │SettingsServ.│  │ResultsService│     │
│  └──────┬──────┘   └──────┬──────┘   └──────┬──────┘   └──────┬──────┘    │
└─────────┼────────────────┼────────────────┼────────────────┼──────────────┘
          │                │                │                │
┌─────────┼────────────────┼────────────────┼────────────────┼──────────────┐
│         │     CORE LAYER │                │                │              │
│         │                │                │                │              │
│  ┌──────┴──────┐   ┌─────┴──────┐   ┌─────┴──────┐   ┌─────┴──────┐       │
│  │WorkflowRunner│  │ActionFactory│  │TemplateExp. │  │ResultProcess│       │
│  └──────┬──────┘   └──────┬──────┘   └──────┬──────┘   └──────┬──────┘    │
│         │                 │                 │                 │           │
│         │          ┌──────┴──────┐          │                 │           │
│         │          │ ActionBase  │          │                 │           │
│         │          │ Hierarchy   │          │                 │           │
│         │          └─────────────┘          │                 │           │
└─────────┼────────────────┼────────────────┼────────────────┼──────────────┘
          │                │                │                │
┌─────────┼────────────────┼────────────────┼────────────────┼──────────────┐
│         │  INFRASTRUCTURE LAYER           │                │              │
│         │                │                │                │              │
│  ┌──────┴──────┐   ┌─────┴──────┐   ┌─────┴──────┐   ┌─────┴──────┐       │
│  │WorkflowRepo. │  │WebDrivers   │  │CredentialRepo│ │ErrorHandlers│       │
│  └─────────────┘   └─────────────┘   └─────────────┘   └─────────────┘    │
│                                                                           │
└───────────────────────────────────────────────────────────────────────────┘
```

## Action Factory Refactoring

### Before:

```
┌───────────────────────────────────────────────────┐
│                 ActionFactory                     │
├───────────────────────────────────────────────────┤
│ - register_action()                               │
│ - create_action()                                 │
│ - get_registered_action_types()                   │
│ - _registry                                       │
│ - validation logic                                │
│ - nested action handling                          │
│ - error handling                                  │
└───────────────────────────────────────────────────┘
```

### After:

```
┌───────────────────────────────────────────────────┐
│                 ActionFactory                     │
├───────────────────────────────────────────────────┤
│ - register_action()                               │
│ - create_action()                                 │
│ - get_registered_action_types()                   │
└─────────────────┬─────────────────────────────────┘
                  │
       ┌──────────┴──────────┬──────────────────┬──────────────────┐
       │                     │                  │                  │
┌──────▼─────────┐  ┌────────▼───────┐  ┌───────▼────────┐  ┌──────▼─────────┐
│ ActionRegistry  │  │ ActionValidator │  │NestedActionHand│  │ ActionCreator  │
├────────────────┤  ├────────────────┤  ├────────────────┤  ├────────────────┤
│- register_action│  │- validate_     │  │- process_nested│  │- create_action │
│- get_action_class│  │  action_data  │  │  _actions      │  │                │
│- get_registered_│  │                │  │                │  │                │
│  types          │  │                │  │                │  │                │
└────────────────┘  └────────────────┘  └────────────────┘  └────────────────┘
```

## Action Execution Flow

```
┌──────────┐     ┌──────────┐     ┌──────────┐     ┌──────────┐     ┌──────────┐
│   User   │     │    UI    │     │Application│     │   Core   │     │Infrastruc│
│          │     │          │     │   Layer   │     │   Layer  │     │   ture   │
└────┬─────┘     └────┬─────┘     └────┬─────┘     └────┬─────┘     └────┬─────┘
     │                │                │                │                │
     │  Run Workflow  │                │                │                │
     │───────────────>│                │                │                │
     │                │                │                │                │
     │                │ Execute Workflow                │                │
     │                │───────────────>│                │                │
     │                │                │                │                │
     │                │                │ Run Workflow   │                │
     │                │                │───────────────>│                │
     │                │                │                │                │
     │                │                │                │ Load Workflow  │
     │                │                │                │───────────────>│
     │                │                │                │                │
     │                │                │                │  Workflow Data │
     │                │                │                │<───────────────│
     │                │                │                │                │
     │                │                │                │ Create Actions │
     │                │                │                │────┐           │
     │                │                │                │    │           │
     │                │                │                │<───┘           │
     │                │                │                │                │
     │                │                │                │ Execute Action │
     │                │                │                │───────────────>│
     │                │                │                │                │
     │                │                │                │ Action Result  │
     │                │                │                │<───────────────│
     │                │                │                │                │
     │                │                │                │ Process Result │
     │                │                │                │────┐           │
     │                │                │                │    │           │
     │                │                │                │<───┘           │
     │                │                │                │                │
     │                │                │ Workflow Result│                │
     │                │                │<───────────────│                │
     │                │                │                │                │
     │                │ Display Results│                │                │
     │                │<───────────────│                │                │
     │                │                │                │                │
     │  See Results   │                │                │                │
     │<───────────────│                │                │                │
     │                │                │                │                │
```

## Action Hierarchy

```
                        ┌───────────┐
                        │ IAction   │
                        └─────┬─────┘
                              │
                        ┌─────┴─────┐
                        │ActionBase │
                        └─────┬─────┘
                              │
          ┌────────────┬──────┼──────┬────────────┬────────────┐
          │            │             │            │            │
    ┌─────┴─────┐┌─────┴─────┐ ┌─────┴─────┐┌─────┴─────┐┌─────┴─────┐
    │NavigateAct││ClickAction│ │TypeAction ││WaitAction ││ScreenshotA│
    └───────────┘└───────────┘ └───────────┘└───────────┘└───────────┘
          │            │             │            │            │
    ┌─────┴─────┐┌─────┴─────┐ ┌─────┴─────┐┌─────┴─────┐┌─────┴─────┐
    │Conditional││LoopAction │ │ErrorHandli││TemplateAct││   ...     │
    │  Action   ││           │ │ngAction   ││           ││           │
    └───────────┘└───────────┘ └───────────┘└───────────┘└───────────┘
```

## Data Flow

```
┌───────────────┐     ┌───────────────┐     ┌───────────────┐
│  User Input   │     │  Action Data  │     │ Action Object │
│ (JSON/UI Form)│────>│  Dictionary   │────>│  Instance     │
└───────────────┘     └───────────────┘     └───────┬───────┘
                                                   │
┌───────────────┐     ┌───────────────┐     ┌──────┴────────┐
│  Result       │     │  Execution    │     │  Browser      │
│  Display      │<────│  Result       │<────│  Interaction  │
└───────────────┘     └───────────────┘     └───────────────┘
```
